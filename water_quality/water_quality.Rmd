---
title: "Water Quality"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
runtime: shiny
---

GROUNDWATER
===
```{r setup, include=FALSE}
library(flexdashboard)
library(tidyverse)
library(plotly)
library(shiny)

groundwater_quality <- read_csv("groundwater_quality.csv")
river_quality <- read_csv("river_quality.csv")
df <- groundwater_quality %>% 
  gather(key = Indicator,
         value = Total_MedVal, c(`E.coli (cfu/100ml)`, `Nitrate nitrogen (g/m3)`),
         -c(Region, Year)) %>% 
  filter(Indicator == "E.coli (cfu/100ml)") %>% 
  group_by(Year) %>% 
  na.omit() %>% 
  summarise(meanval = mean(Total_MedVal))
```

Column {.sidebar}
-----------------------------------------------------------------------
```{r}
selectInput("region", label = "Region", choices = c("All", sort(river_quality$Region)), selected = "All")

radioButtons("indicator", label = "Indicator", choices = c("E.coli", "Nitrate nitrogen"))
```


Column {data-width=650}
-----------------------------------------------------------------------

### Plot 1

```{r}
renderPlotly(ggplotly(df %>% 
  filter(str_detect(Region, if_else(input$region == "All", "", input$region)),
         Indicator == if_else(input$indicator == "E.coli", "E.coli (cfu/100ml)", "Nitrate nitrogen (g/m3)")) %>% 
  ggplot(aes(x = Year, y = Total_MedVal,
             fill = Region), text = paste("Region:", Region)) +
  geom_bar(stat = "identity") +
  theme_bw()))
```

Column {data-width=350}
-----------------------------------------------------------------------

### Chart B

```{r}
renderValueBox({
  new_df <- df %>% 
  filter(str_detect(Region, if_else(input$region == "All", "", input$region)),
         Indicator == if_else(input$indicator == "E.coli", "E.coli (cfu/100ml)", "Nitrate nitrogen (g/m3)")) %>% 
  group_by(Region) %>% 
  summarise(not_assessed = sum(is.na(Total_MedVal)))
  
  new_df %>% 
    valueBox()
})
```

### Chart C

```{r}

```

RIVER
===
Column {data-width=350}
-----------------------------------------------------------------------

### Chart B

```{r}

```

### Chart C

```{r}

```

### Chart D

```{r}

```
 
 